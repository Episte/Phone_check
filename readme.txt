
リスマチック全拠点のIP電話の正常性を確認するプログラムです。

事前準備：
1.CUCM>デバイス>電話のページをexcelにコピペしてください。貼り付け位置は決まっています。
2.NetAttestD3のDHCP>リース情報からcsvをエクスポートして、excelに変換する
3.リザルトを書き込むexcelを用意しておく

IP電話の状態：
今回、IP電話の状態は3つの項目によって分類できる。

1.DHCPからアドレスが割り当てられているか否か
2.CUCMにデータがあるか否か
3.CUCMに登録されているか否か（CUCMの電話ページでIPアドレスが確認できる）

よってIP電話のとるパターンは2^3 = 8パターンである

	DHCP	de-ta 	cucm
1	1	1	1　○正常な状態である
2	1	1	0　○何らかの異常が起きている（別のCUCMに登録されているとか）
3	1	0	1　×ありえない
4	1	0	0　×元々あったIP電話ではない
5	0	1	1　○静的にIPを振られている
6	0	1	0　○データだけCUCMにある（昔使われていて今はないとか）
7	0	0	1　×ありえない
8	0	0	0　×元々あったIP電話ではなく、確認しようがない

この中で確認する必要があるのは1、2、5、6の4パターンである。

1の確認方法：
1.リース情報と、CUCM情報から共通のホスト名を取得する。（1、2がOK）
2.CUCM情報からIPアドレスを取得する。（3がOK）
3.webアクセスして諸設定を確認する。（正常性OK）


2の確認方法：
1.リース情報と、CUCM情報から共通のホスト名を取得する。（1、2がOK）
2.CUCM情報からIPアドレスを取得できない。（3が×）
3.リース情報からIPアドレスを取得し、webアクセスして、諸設定を確認する。


5の確認方法：
1.CUCM情報にあり、リース情報にないホスト名を取得する。（1×、2はOK）
2.CUCM情報からIPアドレスを取得する。（３がOK）
3.webアクセスして諸設定を確認する。（静的にIPを与えられたIP電話の正常性OK）


6の確認方法：
1.CUCM情報にあり、リース情報にないホスト名を取得する。（1×、2はOK）
2.CUCM情報からIPアドレスを取得できない。（３が×）
3.データのみCUCMに存在する（昔使われていたが今は使われていない機器？）